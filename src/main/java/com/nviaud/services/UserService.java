package com.nviaud.services;

import com.nviaud.entities.ProjectEntity;
import io.quarkus.security.identity.SecurityIdentity;
import io.smallrye.jwt.auth.principal.DefaultJWTCallerPrincipal;
import io.smallrye.mutiny.Uni;

import javax.enterprise.context.ApplicationScoped;
import javax.inject.Inject;
import java.util.List;

@ApplicationScoped
public class UserService {

    @Inject
    SecurityIdentity securityIdentity;

    public Uni<List<ProjectEntity>> myProjects(){
        return ProjectEntity.findAll().list();
    }

    public Uni<String> myName(){
        //Principal is type of DefaultJWTCallerPrincipal
        return Uni.createFrom().item(securityIdentity.getPrincipal().getName());
    }

}
