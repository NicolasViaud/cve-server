package com.viaud.services;

import com.nviaud.dto.CveNvdPage;
import com.nviaud.services.NvdService;
import io.quarkus.test.junit.QuarkusTest;
import io.smallrye.mutiny.helpers.test.UniAssertSubscriber;
import org.eclipse.microprofile.rest.client.inject.RestClient;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Disabled;
import org.junit.jupiter.api.Test;

/**
 * https://quarkus.io/guides/rest-client-reactive
 */
@QuarkusTest
public class NvdServiceTest {

    @RestClient
    NvdService nvdService;

    @Test
    @Disabled
    public void testGetCVE202222965() {
        final CveNvdPage cveNvdPage = nvdService.get("CVE-2022-22965", "dictionaryCpes")
                .subscribe().withSubscriber(UniAssertSubscriber.create()).awaitItem().assertCompleted().getItem();
        Assertions.assertNotNull(cveNvdPage);
        Assertions.assertEquals(1, cveNvdPage.totalResults);
    }

}